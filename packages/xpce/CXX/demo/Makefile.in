# This Makefile is a skeleton for compiling C++ programs for XPCE and
# linking them.  It needs a little configuration:
#
#	PCEHOME must be edited to point to the XPCE home directory
#	PCEARCH must be the machine-directory for the architecture you use
#		You can obtain this value using get(@pce, machine, M).
#
# READ-THIS READ-THIS READ-THIS READ-THIS
#
# This Makefile tested on Solaris 2.5
#
# Optimization note: using -O takes hardly longer than no optimization and
# reduces the size of the executable a *lot*.  -O is therefore the
# preferred optimisation mode.

# The @Var@ fields are set by configure

.SUFFIXES: .C .@SO@

PCEHOME=@PCEHOME@
PCEARCH=@builddir@
CC=@CC@
CXX=@CXX@
SO=@SO@
LD=g++
LIBDIR=../../@builddir@
LDSOFLAGS=-shared -L$(LIBDIR)
COFLAGS=-O
CMFLAGS=@CMFLAGS@

all:		pcerc.o
		@echo "This Makefile only provides default rules"

CFLAGS=		-I$(PCEHOME)/include $(CMFLAGS) $(COFLAGS)
PCELIBS=	-lXPCEmain -lXPCE
LDFLAGS=	-L$(LIBDIR) $(PCELIBS)

clean:
		rm -f *.o *.so core a.out *~ *%

pcerc.o:	pcerc.c
		$(CC) $(CFLAGS) -o $@ -c $*.c

# default rules for non GNU-make

.C.o:
		$(CXX) -c $(CFLAGS) $*.C

.o.so:		
		$(LD) $(LDSOFLAGS) -o $@ -lXPCE pcerc.o $*.o
